measure height =
  | Empty -> 0
  | Node (_, _, _, _, _, h) -> h
measure length =
  | Empty -> 0
  | Node (_, cl, _, _, cr, _) -> 1 + cl + cr
(*val makenode:
  l: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] ->
  'a ->
  r: {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | (height v <= height l + 2 and height v >= height l - 2) } ->
  {v': [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v' = (height l >= height r ? height l : height r) + 1 }
val create:
  'a ->
  n: {v: int | v >= 0} ->
  {v': [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | (*length v' = n*) true }
*)
val bal:
  l: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] ->
  'a ->
  r: {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | (height v <= height l + 3 and height v >= height l - 3) } ->
  {v': [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v' <= (height l >= height r ? height l : height r) + 1 and
                                           height v' >= (height l >= height r ? height l : height r) + ((height r <= height l + 2 and height r >= height l - 2) ? 1 : 0) }
(*
(*
val recbal:
  l: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] ->
  'a ->
  r: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] ->
  {v': [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v' <= (height l >= height r ? height l : height r) + 1 and
                                           height v' >= ((height r <= height l + 2 and height r >= height l - 2) ? (height l >= height r ? height l : height r) + 1 : 0) }
                                           *)
val recbal2:
  l: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] ->
  'a ->
  r: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] ->
  {v': [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v' <= (height l >= height r ? height l : height r) + 1 and
                                           height v' >= (height l >= height r ? height l : height r) + ((height r <= height l + 2 and height r >= height l - 2) ? 1 : 0-1) }
val empty:
  {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v = 0}
val singleton:
  'a ->
  {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v = 1}
val append:
  'a ->
  t: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] ->
  {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v <= height t + 1 and height t >= height t - 1 }
val leftmost:
  t: {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v > 0} -> 'a
val remove_leftmost:
  t: {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v > 0} ->
  {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v <= height t and height t >= height t - 1 }
val merge:
  t1: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] ->
  t2: {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | (height v <= height t1 + 2 and height v >= height t1 - 2) } ->
  {v': [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v' <= (height t1 >= height t2 ? height t1 : height t2) + 1 and height v' >= (height t1 >= height t2 ? height t1 : height t2)}
val concat:
  t1: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] ->
  t2: {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | (height v <= height t1 + 2 and height v >= height t1 - 2) } ->
  {v': [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v' <= (height t1 >= height t2 ? height t1 : height t2) + 1 and height v' >= (height t1 >= height t2 ? height t1 : height t2)}
val pop:
  int ->
  t: {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | (*height v > 0*) true } ->
  'a * {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v >= height t - 1 and height v <= height t }
(*
val remove:
  int ->
  t: {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height 0 + 2 and height e3 >= height 0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | (*height v > 0*) true } ->
  {v: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] [z: t . || {e0: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e0 >= 0)}, {e1: int | (e1 = length e0)}, e2: 'a, {e3: [[], [v: true, v: true, v: true, v: true, v: true, v: true]] z | (height e3 <= height e0 + 2 and height e3 >= height e0 - 2) and (height e3 >= 0)}, {e4: int | (e4 = length e3)}, {e5: int | ((e5 = (height e0 >= height e3 ? height e0 : height e3) + 1) and e5 >= 0)}] | height v >= height t - 1 and height v <= height t }
           *)
*)
